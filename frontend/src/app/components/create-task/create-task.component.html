<div class="task-container">
    <div class="form-card">
        <div class="form-header">
            <h2>Create New Task</h2>
            <p>Schedule a new execution in the IRIS Queue</p>
        </div>

        <form [formGroup]="taskForm" (ngSubmit)="saveToQueue()">
            <div class="form-section">
                <div class="section-title">Execution Logic</div>

                <div class="input-group">
                    <label [class.mandatory]="taskForm.get('methodName')?.enabled">Class Name</label>
                    <input type="text" formControlName="className" placeholder="e.g. User.DataProcessor">
                </div>

                <div class="input-group">
                    <label [class.mandatory]="taskForm.get('className')?.value">Method Name</label>
                    <input type="text" formControlName="methodName" placeholder="e.g. RunProcess">
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="input-group">
                    <label>Routine Name</label>
                    <input type="text" formControlName="routineName" placeholder="e.g. Start^TaskRoutine">
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">Configuration</div>

                <div class="input-group">
                    <label>Priority Level</label>
                    <select formControlName="priority">
                        <option [value]="10">ðŸ”¥ High Priority (10)</option>`
                        <option [value]="5">âš¡ Normal (5)</option>
                        <option [value]="1">ðŸ’¤ Low Priority (1)</option>
                    </select>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">Arguments</div>
                <div formArrayName="args" class="args-list">
                    <div *ngFor="let arg of args.controls; let i=index" [formGroupName]="i" class="arg-row">
                        <input type="text" formControlName="key" placeholder="Key">
                        <input type="text" formControlName="value" placeholder="Value">
                        <button type="button" class="btn-remove" (click)="removeRow(i)" *ngIf="args.length > 1">
                            &times;
                        </button>
                    </div>
                </div>
                <button type="button" class="btn-outline" (click)="addRow()">
                    <span>+</span> Add Argument
                </button>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-submit" [disabled]="!taskForm.valid || loading">
                    {{ loading ? 'Saving...' : 'Push to Queue' }}
                </button>
            </div>
        </form>
    </div>
</div>